import{a as w}from"./3VFJM5NZ-Cpt1Stcw.js";import{q as L,d as S,f as E,g as P,r as R,t as D,v as j,u as x}from"./index-BtT_u8Hx.js";import{a as H,e as O,j as _}from"./iframe-CSkHCzVC.js";import{a as N}from"./index-BqxmMzY1.js";import{D as V}from"./JHMNWOLY-BqZJcmiH.js";var k="focusScope.autoFocusOnMount",I="focusScope.autoFocusOnUnmount",U={bubbles:!1,cancelable:!0},M={stack:[],active(){return this.stack[0]},add(r){r!==this.active()&&this.active()?.pause(),this.stack=R(this.stack,r),this.stack.unshift(r)},remove(r){this.stack=R(this.stack,r),this.active()?.resume()}};function Y(r,l){const[d,f]=H(!1),g={pause(){f(!0)},resume(){f(!1)}};let b=null;const v=e=>r.onMountAutoFocus?.(e),h=e=>r.onUnmountAutoFocus?.(e),t=()=>P(l()),s=()=>{const e=t().createElement("span");return e.setAttribute("data-focus-trap",""),e.tabIndex=0,Object.assign(e.style,j),e},o=()=>{const e=l();return e?x(e,!0).filter(n=>!n.hasAttribute("data-focus-trap")):[]},A=()=>{const e=o();return e.length>0?e[0]:null},i=()=>{const e=o();return e.length>0?e[e.length-1]:null},C=()=>{const e=l();if(!e)return!1;const n=L(e);return!n||S(e,n)?!1:D(n)};O(()=>{const e=l();if(!e)return;M.add(g);const n=L(e);if(!S(e,n)){const a=new CustomEvent(k,U);e.addEventListener(k,v),e.dispatchEvent(a),a.defaultPrevented||setTimeout(()=>{E(A()),L(e)===n&&E(e)},0)}_(()=>{e.removeEventListener(k,v),setTimeout(()=>{const a=new CustomEvent(I,U);C()&&a.preventDefault(),e.addEventListener(I,h),e.dispatchEvent(a),a.defaultPrevented||E(n??t().body),e.removeEventListener(I,h),M.remove(g)},0)})}),O(()=>{const e=l();if(!e||!N(r.trapFocus)||d())return;const n=a=>{const m=a.target;m?.closest(`[${w}]`)||(S(e,m)?b=m:E(b))},u=a=>{const T=a.relatedTarget??L(e);T?.closest(`[${w}]`)||S(e,T)||E(b)};t().addEventListener("focusin",n),t().addEventListener("focusout",u),_(()=>{t().removeEventListener("focusin",n),t().removeEventListener("focusout",u)})}),O(()=>{const e=l();if(!e||!N(r.trapFocus)||d())return;const n=s();e.insertAdjacentElement("afterbegin",n);const u=s();e.insertAdjacentElement("beforeend",u);function a(T){const F=A(),y=i();T.relatedTarget===F?E(y):E(F)}n.addEventListener("focusin",a),u.addEventListener("focusin",a);const m=new MutationObserver(T=>{for(const F of T)F.previousSibling===u&&(u.remove(),e.insertAdjacentElement("beforeend",u)),F.nextSibling===n&&(n.remove(),e.insertAdjacentElement("afterbegin",n))});m.observe(e,{childList:!0,subtree:!1}),_(()=>{n.removeEventListener("focusin",a),u.removeEventListener("focusin",a),n.remove(),u.remove(),m.disconnect()})})}function z(r){O(()=>{N(r.isDisabled)||_(W(N(r.targets),N(r.root)))})}var p=new WeakMap,c=[];function W(r,l=document.body){const d=new Set(r),f=new Set,g=t=>{for(const i of t.querySelectorAll(`[${V}], [${w}]`))d.add(i);const s=i=>{if(d.has(i)||i.parentElement&&f.has(i.parentElement)&&i.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(const C of d)if(i.contains(C))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},o=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s}),A=s(t);if(A===NodeFilter.FILTER_ACCEPT&&b(t),A!==NodeFilter.FILTER_REJECT){let i=o.nextNode();for(;i!=null;)b(i),i=o.nextNode()}},b=t=>{const s=p.get(t)??0;t.getAttribute("aria-hidden")==="true"&&s===0||(s===0&&t.setAttribute("aria-hidden","true"),f.add(t),p.set(t,s+1))};c.length&&c[c.length-1].disconnect(),g(l);const v=new MutationObserver(t=>{for(const s of t)if(!(s.type!=="childList"||s.addedNodes.length===0)&&![...d,...f].some(o=>o.contains(s.target))){for(const o of s.removedNodes)o instanceof Element&&(d.delete(o),f.delete(o));for(const o of s.addedNodes)(o instanceof HTMLElement||o instanceof SVGElement)&&(o.dataset.liveAnnouncer==="true"||o.dataset.reactAriaTopLayer==="true")?d.add(o):o instanceof Element&&g(o)}});v.observe(l,{childList:!0,subtree:!0});const h={observe(){v.observe(l,{childList:!0,subtree:!0})},disconnect(){v.disconnect()}};return c.push(h),()=>{v.disconnect();for(const t of f){const s=p.get(t);if(s==null)return;s===1?(t.removeAttribute("aria-hidden"),p.delete(t)):p.set(t,s-1)}h===c[c.length-1]?(c.pop(),c.length&&c[c.length-1].observe()):c.splice(c.indexOf(h),1)}}export{Y as a,z as c};
