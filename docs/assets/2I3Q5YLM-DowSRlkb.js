import{a as F,j as k,L as de,k as ge,M as z,d as S,s as L,e as O,f as fe,t as N,A as be,p as pe,m as y,i as T,c as f,F as R,S as C,l as H,G as me,n as he,h as W,g as q,u as G,N as ve,O as A}from"./iframe-Clet01EE.js";import{i as ye,a as Ie,b as xe}from"./QZDH5R5B-PBS_kkPt.js";import{u as Se}from"./ZZYKR3VO-BgHOJ8It.js";import{a as j,v as we,m as w,c as J,e as m,f as De,p as Me,B as Fe}from"./index-CNxaL1Ec.js";import{m as K}from"./index-BgurTJCO.js";import{c as Ce}from"./N3GAC5SS-wWDK6RCs.js";import{c as B}from"./JNCCF6MP-4sxnBYeu.js";import{P as x}from"./FLVHQV4A-BgLTf8G_.js";import{_ as Le}from"./5WXHJDCZ-DghNgBBa.js";import{a as p}from"./index-xPNqmJU7.js";const P=Symbol("fallback");function _(r){for(const o of r)o.dispose()}function Pe(r,o,t,b={}){const e=new Map;return k(()=>_(e.values())),()=>{const c=r()||[];return c[de],ge(()=>{if(!c.length)return _(e.values()),e.clear(),b.fallback?[z(u=>(e.set(P,{dispose:u}),b.fallback()))]:[];const g=new Array(c.length),d=e.get(P);if(!e.size||d){d?.dispose(),e.delete(P);for(let n=0;n<c.length;n++){const u=c[n],a=o(u,n);l(g,u,n,a)}return g}const i=new Set(e.keys());for(let n=0;n<c.length;n++){const u=c[n],a=o(u,n);i.delete(a);const s=e.get(a);s?(g[n]=s.mapped,s.setIndex?.(n),s.setItem(()=>u)):l(g,u,n,a)}for(const n of i)e.get(n)?.dispose(),e.delete(n);return g})};function l(c,g,d,i){z(n=>{const[u,a]=S(g),s={setItem:a,dispose:n};if(t.length>1){const[I,h]=S(d);s.setIndex=h,s.mapped=t(u,I)}else s.mapped=t(u);e.set(i,s),c[d]=s.mapped})}}function ke(r){const{by:o}=r;return F(Pe(()=>r.each,typeof o=="function"?o:t=>t[o],r.children,"fallback"in r?{fallback:()=>r.fallback}:void 0))}var Oe=N("<option>"),Ke=N("<div aria-hidden=true><input type=text style=font-size:16px><select tabindex=-1><option>");function qe(r){let o;const[t,b]=L(r,["ref","onChange","collection","selectionManager","isOpen","isMultiple","isVirtualized","focusTrigger"]),e=Se(),[l,c]=S(!1),g=d=>{const i=t.collection.getItem(d);return f(C,{get when(){return i?.type==="item"},get children(){var n=Oe();return n.value=d,T(n,()=>i?.textValue),H(()=>n.selected=t.selectionManager.isSelected(d)),n}})};return O(fe(()=>t.selectionManager.selectedKeys(),(d,i)=>{i&&ye(d,i)||(c(!0),o?.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),o?.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})))},{defer:!0})),(()=>{var d=Ke(),i=d.firstChild,n=i.nextSibling;n.firstChild,i.addEventListener("focus",()=>t.focusTrigger()),n.addEventListener("change",a=>{j(a,t.onChange),l()||t.selectionManager.setSelectedKeys(new Set([a.target.value])),c(!1)});var u=K(a=>o=a,t.ref);return typeof u=="function"&&be(u,n),pe(n,y({get multiple(){return t.isMultiple},get name(){return e.name()},get required(){return e.isRequired()},get disabled(){return e.isDisabled()},get size(){return t.collection.getSize()},get value(){return t.selectionManager.firstSelectedKey()??""}},b),!1,!0),T(n,f(C,{get when(){return t.isVirtualized},get fallback(){return f(R,{get each(){return[...t.collection.getKeys()]},children:g})},get children(){return f(R,{get each(){return[...t.selectionManager.selectedKeys()]},children:g})}}),null),H(a=>{var s=we,I=t.selectionManager.isFocused()||t.isOpen?-1:0,h=e.isRequired(),D=e.isDisabled(),M=e.isReadOnly();return a.e=me(d,s,a.e),I!==a.t&&he(i,"tabindex",a.t=I),h!==a.a&&(i.required=a.a=h),D!==a.o&&(i.disabled=a.o=D),M!==a.i&&(i.readOnly=a.i=M),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),d})()}var $=new WeakMap;function Ee(r){let o=$.get(r);if(o!=null)return o;o=0;for(const t of r)t.type==="item"&&o++;return $.set(r,o),o}var Ve={};Le(Ve,{Item:()=>Z,ItemDescription:()=>ee,ItemIndicator:()=>te,ItemLabel:()=>oe,Listbox:()=>Ue,Root:()=>ne,Section:()=>re,useListboxContext:()=>X});var Q=q();function X(){const r=G(Q);if(r===void 0)throw new Error("[kobalte]: `useListboxContext` must be used within a `Listbox` component");return r}var Y=q();function E(){const r=G(Y);if(r===void 0)throw new Error("[kobalte]: `useListboxItemContext` must be used within a `Listbox.Item` component");return r}function Z(r){let o;const t=X(),b=`${t.generateId("item")}-${W()}`,e=w({id:b},r),[l,c]=L(e,["ref","item","aria-label","aria-labelledby","aria-describedby","onPointerMove","onPointerDown","onPointerUp","onClick","onKeyDown","onMouseDown","onFocus"]),[g,d]=S(),[i,n]=S(),u=()=>t.listState().selectionManager(),a=()=>u().focusedKey()===l.item.key,s=Ie({key:()=>l.item.key,selectionManager:u,shouldSelectOnPressUp:t.shouldSelectOnPressUp,allowsDifferentPressOrigin:()=>t.shouldSelectOnPressUp()&&t.shouldFocusOnHover(),shouldUseVirtualFocus:t.shouldUseVirtualFocus,disabled:()=>l.item.disabled},()=>o),I=()=>{if(u().selectionMode()!=="none")return s.isSelected()},h=F(()=>!(Me()&&Fe())),D=()=>h()?l["aria-label"]:void 0,M=()=>h()?g():void 0,se=()=>h()?i():void 0,ie=()=>{if(!t.isVirtualized())return;const v=t.listState().collection().getItem(l.item.key)?.index;return v!=null?v+1:void 0},ae=()=>{if(t.isVirtualized())return Ee(t.listState().collection())},le=v=>{j(v,l.onPointerMove),v.pointerType==="mouse"&&!s.isDisabled()&&t.shouldFocusOnHover()&&(De(v.currentTarget),u().setFocused(!0),u().setFocusedKey(l.item.key))},V=F(()=>({"data-disabled":s.isDisabled()?"":void 0,"data-selected":s.isSelected()?"":void 0,"data-highlighted":a()?"":void 0})),ce={isSelected:s.isSelected,dataset:V,generateId:J(()=>c.id),registerLabelId:B(d),registerDescriptionId:B(n)};return f(Y.Provider,{value:ce,get children(){return f(x,y({as:"li",ref(v){var U=K(ue=>o=ue,l.ref);typeof U=="function"&&U(v)},role:"option",get tabIndex(){return s.tabIndex()},get"aria-disabled"(){return s.isDisabled()},get"aria-selected"(){return I()},get"aria-label"(){return D()},get"aria-labelledby"(){return M()},get"aria-describedby"(){return se()},get"aria-posinset"(){return ie()},get"aria-setsize"(){return ae()},get"data-key"(){return s.dataKey()},get onPointerDown(){return m([l.onPointerDown,s.onPointerDown])},get onPointerUp(){return m([l.onPointerUp,s.onPointerUp])},get onClick(){return m([l.onClick,s.onClick])},get onKeyDown(){return m([l.onKeyDown,s.onKeyDown])},get onMouseDown(){return m([l.onMouseDown,s.onMouseDown])},get onFocus(){return m([l.onFocus,s.onFocus])},onPointerMove:le},V,c))}})}function ee(r){const o=E(),t=w({id:o.generateId("description")},r);return O(()=>k(o.registerDescriptionId(t.id))),f(x,y({as:"div"},()=>o.dataset(),t))}function te(r){const o=E(),t=w({id:o.generateId("indicator")},r),[b,e]=L(t,["forceMount"]);return f(C,{get when(){return b.forceMount||o.isSelected()},get children(){return f(x,y({as:"div","aria-hidden":"true"},()=>o.dataset(),e))}})}function oe(r){const o=E(),t=w({id:o.generateId("label")},r);return O(()=>k(o.registerLabelId(t.id))),f(x,y({as:"div"},()=>o.dataset(),t))}function ne(r){let o;const t=`listbox-${W()}`,b=w({id:t,selectionMode:"single",virtualized:!1},r),[e,l]=L(b,["ref","children","renderItem","renderSection","value","defaultValue","onChange","options","optionValue","optionTextValue","optionDisabled","optionGroupChildren","state","keyboardDelegate","autoFocus","selectionMode","shouldFocusWrap","shouldUseVirtualFocus","shouldSelectOnPressUp","shouldFocusOnHover","allowDuplicateSelectionEvents","disallowEmptySelection","selectionBehavior","selectOnFocus","disallowTypeAhead","allowsTabNavigation","virtualized","scrollToItem","scrollRef","onKeyDown","onMouseDown","onFocusIn","onFocusOut"]),c=F(()=>e.state?e.state:xe({selectedKeys:()=>e.value,defaultSelectedKeys:()=>e.defaultValue,onSelectionChange:e.onChange,allowDuplicateSelectionEvents:()=>p(e.allowDuplicateSelectionEvents),disallowEmptySelection:()=>p(e.disallowEmptySelection),selectionBehavior:()=>p(e.selectionBehavior),selectionMode:()=>p(e.selectionMode),dataSource:()=>e.options??[],getKey:()=>e.optionValue,getTextValue:()=>e.optionTextValue,getDisabled:()=>e.optionDisabled,getSectionChildren:()=>e.optionGroupChildren})),g=Ce({selectionManager:()=>c().selectionManager(),collection:()=>c().collection(),autoFocus:()=>p(e.autoFocus),shouldFocusWrap:()=>p(e.shouldFocusWrap),keyboardDelegate:()=>e.keyboardDelegate,disallowEmptySelection:()=>p(e.disallowEmptySelection),selectOnFocus:()=>p(e.selectOnFocus),disallowTypeAhead:()=>p(e.disallowTypeAhead),shouldUseVirtualFocus:()=>p(e.shouldUseVirtualFocus),allowsTabNavigation:()=>p(e.allowsTabNavigation),isVirtualized:()=>e.virtualized,scrollToKey:()=>e.scrollToItem},()=>o,()=>e.scrollRef?.()),d={listState:c,generateId:J(()=>l.id),shouldUseVirtualFocus:()=>b.shouldUseVirtualFocus,shouldSelectOnPressUp:()=>b.shouldSelectOnPressUp,shouldFocusOnHover:()=>b.shouldFocusOnHover,isVirtualized:()=>e.virtualized};return f(Q.Provider,{value:d,get children(){return f(x,y({as:"ul",ref(i){var n=K(u=>o=u,e.ref);typeof n=="function"&&n(i)},role:"listbox",get tabIndex(){return g.tabIndex()},get"aria-multiselectable"(){return c().selectionManager().selectionMode()==="multiple"?!0:void 0},get onKeyDown(){return m([e.onKeyDown,g.onKeyDown])},get onMouseDown(){return m([e.onMouseDown,g.onMouseDown])},get onFocusIn(){return m([e.onFocusIn,g.onFocusIn])},get onFocusOut(){return m([e.onFocusOut,g.onFocusOut])}},l,{get children(){return f(C,{get when(){return!e.virtualized},get fallback(){return e.children?.(c().collection)},get children(){return f(ke,{get each(){return[...c().collection()]},by:"key",children:i=>f(ve,{get children(){return[f(A,{get when(){return i().type==="section"},get children(){return e.renderSection?.(i())}}),f(A,{get when(){return i().type==="item"},get children(){return e.renderItem?.(i())}})]}})})}})}}))}})}function re(r){return f(x,y({as:"li",role:"presentation"},r))}var Ue=Object.assign(ne,{Item:Z,ItemDescription:ee,ItemIndicator:te,ItemLabel:oe,Section:re});export{qe as H,ne as L,re as a,oe as b,te as c,ee as d,Z as e,Ee as g};
